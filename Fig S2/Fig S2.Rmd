---
title: "Figure S2 DEGs between the two pig breeds (N = 5 for each group)."
author: "Liang Huang"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Clean workspace
rm(list=ls()) 
# Set output directory
output_dir="./"
```


#a Venn plot

(A) Venn diagram show the gene counts of DEGs between two pig breeds.
This figure is drawn by Majorbio (Shanghai, China)

#b PCA

(B) PCA show the distance between two groups.

```{r}
library(tidyverse)
library(factoextra)
library(ggplot2)
library(genefilter)
library(stringr)
#### ?????????????????????
library(xlsx)
file="./Transcriptomic data.xlsx"
data <- read.xlsx(file, 1,header = T,row.names=1)
group=read.xlsx(file, 2,header = T,row.names=1)


rv <- genefilter::rowVars(data)
select <- order(rv, decreasing = TRUE)[seq_len(1000)]
pca_data <- cbind(t(log10(data[select,]+1)),group)
expr_pca <- prcomp(pca_data[,1:1000],
                   scale = T,center = T)



library(factoextra)
library(ggforce)
## ?????????
fviz_screeplot(expr_pca, addlabels = TRUE, ylim = c(0, 80)) 
color_mapping <- c("DLY" = "#4e62ab", "JXB" = "#d6404e")

PCA <- fviz_pca_ind(expr_pca,
                    label = 'none',
                    geom.ind = 'point',
                    pointshape = 20,
                    pointsize = 2,
                    pointfill = group$group, 
                    col.ind = group$group,
                    habillage = group$group,
                    repel = F,
                    addEllipses = T,
                    ellipse.level = 0.95,
                    invisible = "none",
                    palette = color_mapping) +
  scale_fill_manual(values = color_mapping) + 
  scale_color_manual(values = color_mapping) +  
  theme_bw(base_size = 20) +
  theme(text = element_text(size = 20),
        legend.margin = margin(-10),
        axis.text = element_text(size = 12, colour = 'black'),
        legend.text = element_text(size = 16),
        legend.title = element_blank(),
        legend.justification = c("right", "top"),
        legend.key.size = unit(0.5, "cm"),
        panel.grid.major = element_line(colour = "white"),
        panel.grid.minor = element_line(colour = "white")) +
  ggtitle('') 
PCA
```

#c volcano plot

(C) Volcano plot show significantly different DEGs.
This figure is drawn by Majorbio (Shanghai, China)

#d Network

(D) Network show interactions between proteins, colors represent pathways the proteins belong to.
This was drawn by using String (online database) and Cytoscape.
